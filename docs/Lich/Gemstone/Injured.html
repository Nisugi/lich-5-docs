<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Lich::Gemstone::Injured
  
    &mdash; Lich 5 Documentation
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Lich::Gemstone::Injured";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (I)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../Lich.html" title="Lich (module)">Lich</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Gemstone.html" title="Lich::Gemstone (module)">Gemstone</a></span></span>
     &raquo; 
    <span class="title">Injured</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Lich::Gemstone::Injured
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="CharacterStatus.html" title="Lich::Gemstone::CharacterStatus (class)">CharacterStatus</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="CharacterStatus.html" title="Lich::Gemstone::CharacterStatus (class)">CharacterStatus</a></span></li>
          
            <li class="next">Lich::Gemstone::Injured</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>documented/gemstone/injured.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Represents the characterâ€™s injury status in the Gemstone module.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
        <h5 class="example_title"><div class='inline'>
<p>Creating an instance of Injured</p>
</div></h5>
      
      <pre class="example code"><code><span class='id identifier rubyid_injured_status'>injured_status</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Lich.html" title="Lich (module)">Lich</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Gemstone.html" title="Lich::Gemstone (module)">Gemstone</a></span></span><span class='op'>::</span><span class='const'>Injured</span></code></pre>
    
  </div>


</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="BODY_PART_GROUPS-constant" class="">BODY_PART_GROUPS =
          <div class="docstring">
  <div class="discussion">
    
<p>A constant that groups body parts for injury checks. Each key represents a group of body parts.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
  <span class='label'>eyes:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>leftEye</span><span class='words_sep'> </span><span class='tstring_content'>rightEye</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>arms:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>leftArm</span><span class='words_sep'> </span><span class='tstring_content'>rightArm</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>hands:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>leftHand</span><span class='words_sep'> </span><span class='tstring_content'>rightHand</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>legs:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>leftLeg</span><span class='words_sep'> </span><span class='tstring_content'>rightLeg</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>feet:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>leftFoot</span><span class='words_sep'> </span><span class='tstring_content'>rightFoot</span><span class='tstring_end'>]</span></span><span class='comma'>,</span>
  <span class='label'>head_and_nerves:</span> <span class='qsymbols_beg'>%i[</span><span class='tstring_content'>head</span><span class='words_sep'> </span><span class='tstring_content'>nsys</span><span class='tstring_end'>]</span></span>
<span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span></pre></dd>
      
    </dl>
  







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#able_to_cast%3F-class_method" title="able_to_cast? (class method)">.<strong>able_to_cast?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the character is able to cast spells based on their injury status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#able_to_search%3F-class_method" title="able_to_search? (class method)">.<strong>able_to_search?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the character is able to search based on their injury status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#able_to_sneak%3F-class_method" title="able_to_sneak? (class method)">.<strong>able_to_sneak?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the character is able to sneak based on their injury status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#able_to_use_ranged%3F-class_method" title="able_to_use_ranged? (class method)">.<strong>able_to_use_ranged?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if the character is able to use ranged weapons based on their injury status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#bypasses_injuries%3F-class_method" title="bypasses_injuries? (class method)">.<strong>bypasses_injuries?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Determines if the character can bypass injuries based on active effects.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#effective_injury_from_hashes-class_method" title="effective_injury_from_hashes (class method)">.<strong>effective_injury_from_hashes</strong>(body_part, wounds_hash, scars_hash)  &#x21d2; Integer </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Calculates the effective injury from wounds and scars for a given body part.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_injury_data-class_method" title="get_injury_data (class method)">.<strong>get_injury_data</strong>  &#x21d2; Array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Retrieves injury data, utilizing caching for efficiency.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#injuries_at_or_above_rank%3F-class_method" title="injuries_at_or_above_rank? (class method)">.<strong>injuries_at_or_above_rank?</strong>(rank, wounds_hash, scars_hash, *parts)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if there are injuries at or above a specific rank for given body parts.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#injuries_at_rank%3F-class_method" title="injuries_at_rank? (class method)">.<strong>injuries_at_rank?</strong>(rank, wounds_hash, scars_hash, *parts)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks if there are injuries at a specific rank for given body parts.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="CharacterStatus.html" title="Lich::Gemstone::CharacterStatus (class)">CharacterStatus</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="CharacterStatus.html#fix_injury_mode-class_method" title="Lich::Gemstone::CharacterStatus.fix_injury_mode (method)">fix_injury_mode</a></span>, <span class='object_link'><a href="CharacterStatus.html#method_missing-class_method" title="Lich::Gemstone::CharacterStatus.method_missing (method)">method_missing</a></span></p>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="able_to_cast?-class_method">
  
    .<strong>able_to_cast?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if the character is able to cast spells based on their injury status.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_can_cast'>can_cast</span> <span class='op'>=</span> <span class='id identifier rubyid_able_to_cast?'>able_to_cast?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if the character can cast spells.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_able_to_cast?'>able_to_cast?</span>
  <span class='id identifier rubyid_fix_injury_mode'><span class='object_link'><a href="../../top-level-namespace.html#fix_injury_mode-instance_method" title="#fix_injury_mode (method)">fix_injury_mode</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>both</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># Fetch cached or fresh injury data
</span>  <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span>

  <span class='comment'># Rank 3 critical injuries prevent casting (Sigil cannot bypass)
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='symbol'>:head</span><span class='comma'>,</span> <span class='symbol'>:nsys</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:eyes</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Check for rank 3 in arms/hands (worst of arm vs hand per side)
</span>  <span class='id identifier rubyid_left_arm'>left_arm</span> <span class='op'>=</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='symbol'>:leftArm</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_left_hand'>left_hand</span> <span class='op'>=</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='symbol'>:leftHand</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_right_arm'>right_arm</span> <span class='op'>=</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='symbol'>:rightArm</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_right_hand'>right_hand</span> <span class='op'>=</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='symbol'>:rightHand</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_left_side'>left_side</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_left_arm'>left_arm</span><span class='comma'>,</span> <span class='id identifier rubyid_left_hand'>left_hand</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
  <span class='id identifier rubyid_right_side'>right_side</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_right_arm'>right_arm</span><span class='comma'>,</span> <span class='id identifier rubyid_right_hand'>right_hand</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>

  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_left_side'>left_side</span> <span class='op'>==</span> <span class='int'>3</span> <span class='op'>||</span> <span class='id identifier rubyid_right_side'>right_side</span> <span class='op'>==</span> <span class='int'>3</span>

  <span class='comment'># Sigil of Determination bypasses rank 2 or lower injuries
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span>

  <span class='comment'># Head or nerve injuries &gt; rank 1 prevent casting
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:head_and_nerves</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Cumulative injuries &gt;= 3 prevent casting
</span>  <span class='id identifier rubyid_eyes_total'>eyes_total</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:eyes</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sum'>sum</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='op'>|</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_part'>part</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_eyes_total'>eyes_total</span> <span class='op'>&gt;=</span> <span class='int'>3</span>

  <span class='id identifier rubyid_arms_total'>arms_total</span> <span class='op'>=</span> <span class='id identifier rubyid_left_side'>left_side</span> <span class='op'>+</span> <span class='id identifier rubyid_right_side'>right_side</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_arms_total'>arms_total</span> <span class='op'>&gt;=</span> <span class='int'>3</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="able_to_search?-class_method">
  
    .<strong>able_to_search?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if the character is able to search based on their injury status.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_can_search'>can_search</span> <span class='op'>=</span> <span class='id identifier rubyid_able_to_search?'>able_to_search?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if the character can search.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_able_to_search?'>able_to_search?</span>
  <span class='id identifier rubyid_fix_injury_mode'><span class='object_link'><a href="../../top-level-namespace.html#fix_injury_mode-instance_method" title="#fix_injury_mode (method)">fix_injury_mode</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>both</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span>

  <span class='comment'># Rank 3 critical injuries prevent searching (Sigil cannot bypass)
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='symbol'>:head</span><span class='comma'>,</span> <span class='symbol'>:nsys</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:eyes</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Sigil of Determination bypasses rank 2 or lower injuries
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span>

  <span class='comment'># Rank 2+ head or nerve injury prevents searching
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:head_and_nerves</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="able_to_sneak?-class_method">
  
    .<strong>able_to_sneak?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if the character is able to sneak based on their injury status.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_can_sneak'>can_sneak</span> <span class='op'>=</span> <span class='id identifier rubyid_able_to_sneak?'>able_to_sneak?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if the character can sneak.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 154</span>

<span class='kw'>def</span> <span class='id identifier rubyid_able_to_sneak?'>able_to_sneak?</span>
  <span class='id identifier rubyid_fix_injury_mode'><span class='object_link'><a href="../../top-level-namespace.html#fix_injury_mode-instance_method" title="#fix_injury_mode (method)">fix_injury_mode</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>both</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span>

  <span class='comment'># Rank 3 leg/foot injuries always prevent sneaking, but these are NOT critical
</span>  <span class='comment'># (Sigil cannot bypass, but they&#39;re not in the critical list for other actions)
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:legs</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:feet</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Sigil of Determination bypasses rank 2 or lower injuries
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span>

  <span class='comment'># Any leg or foot injury &gt; rank 1 prevents sneaking
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:legs</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:feet</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="able_to_use_ranged?-class_method">
  
    .<strong>able_to_use_ranged?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if the character is able to use ranged weapons based on their injury status.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_can_use_ranged'>can_use_ranged</span> <span class='op'>=</span> <span class='id identifier rubyid_able_to_use_ranged?'>able_to_use_ranged?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if the character can use ranged weapons.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 197</span>

<span class='kw'>def</span> <span class='id identifier rubyid_able_to_use_ranged?'>able_to_use_ranged?</span>
  <span class='id identifier rubyid_fix_injury_mode'><span class='object_link'><a href="../../top-level-namespace.html#fix_injury_mode-instance_method" title="#fix_injury_mode (method)">fix_injury_mode</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>both</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span>

  <span class='comment'># Rank 3 critical injuries prevent ranged weapon use (Sigil cannot bypass)
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='int'>3</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='symbol'>:head</span><span class='comma'>,</span> <span class='symbol'>:nsys</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:eyes</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:arms</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:hands</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='comment'># Sigil of Determination bypasses rank 2 or lower injuries
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span>

  <span class='comment'># Any single arm or hand injury &gt;= rank 2 prevents ranged weapon use
</span>  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:arms</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='op'>*</span><span class='const'><span class='object_link'><a href="#BODY_PART_GROUPS-constant" title="Lich::Gemstone::Injured::BODY_PART_GROUPS (constant)">BODY_PART_GROUPS</a></span></span><span class='lbracket'>[</span><span class='symbol'>:hands</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:nsys</span><span class='rparen'>)</span>

  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="bypasses_injuries?-class_method">
  
    .<strong>bypasses_injuries?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Determines if the character can bypass injuries based on active effects.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_can_bypass'>can_bypass</span> <span class='op'>=</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if the character can bypass injuries.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_bypasses_injuries?'>bypasses_injuries?</span>
  <span class='const'><span class='object_link'><a href="Effects.html" title="Lich::Gemstone::Effects (module)">Effects</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Effects.html#Buffs-constant" title="Lich::Gemstone::Effects::Buffs (constant)">Buffs</a></span></span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Sigil of Determination</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="effective_injury_from_hashes-class_method">
  
    .<strong>effective_injury_from_hashes</strong>(body_part, wounds_hash, scars_hash)  &#x21d2; <tt>Integer</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Calculates the effective injury from wounds and scars for a given body part.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_effective_injury'>effective_injury</span> <span class='op'>=</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='symbol'>:leftArm</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>body_part</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The body part to check (e.g., :leftArm).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wounds_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing wounds data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scars_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing scars data.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The effective injury value.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 66</span>

<span class='kw'>def</span> <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_body_part'>body_part</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_scar'>scar</span> <span class='op'>=</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_body_part'>body_part</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_wound'>wound</span> <span class='op'>=</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_body_part'>body_part</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='int'>0</span>
  <span class='id identifier rubyid_effective_scar'>effective_scar</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_scar'>scar</span> <span class='op'>==</span> <span class='int'>1</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='int'>0</span> <span class='op'>:</span> <span class='id identifier rubyid_scar'>scar</span>

  <span class='lbracket'>[</span><span class='id identifier rubyid_wound'>wound</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_scar'>effective_scar</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_injury_data-class_method">
  
    .<strong>get_injury_data</strong>  &#x21d2; <tt>Array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
  <div class="note notetag">
    <strong>Note:</strong>
    <div class='inline'>
<p>This method uses a mutex for thread safety.</p>
</div>
  </div>


<p>Retrieves injury data, utilizing caching for efficiency.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An array containing wounds and scars data.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 31</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_injury_data'>get_injury_data</span>
  <span class='id identifier rubyid_current_key'>current_key</span> <span class='op'>=</span> <span class='const'>XMLData</span><span class='period'>.</span><span class='id identifier rubyid_injuries'>injuries</span>

  <span class='comment'># Fast path: return cached data if key hasn&#39;t changed
</span>  <span class='kw'>if</span> <span class='ivar'>@injury_cache_key</span> <span class='op'>==</span> <span class='id identifier rubyid_current_key'>current_key</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@wounds_cache</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@scars_cache</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='ivar'>@wounds_cache</span><span class='comma'>,</span> <span class='ivar'>@scars_cache</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>

  <span class='comment'># Slow path: fetch new data with mutex protection
</span>  <span class='ivar'>@cache_mutex</span><span class='period'>.</span><span class='id identifier rubyid_synchronize'>synchronize</span> <span class='kw'>do</span>
    <span class='comment'># Double-check after acquiring lock (another thread may have updated)
</span>    <span class='kw'>if</span> <span class='ivar'>@injury_cache_key</span> <span class='op'>==</span> <span class='id identifier rubyid_current_key'>current_key</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@wounds_cache</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@scars_cache</span>
      <span class='kw'>return</span> <span class='lbracket'>[</span><span class='ivar'>@wounds_cache</span><span class='comma'>,</span> <span class='ivar'>@scars_cache</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='comment'># Fetch fresh data
</span>    <span class='id identifier rubyid_wounds'>wounds</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Wounds.html" title="Lich::Gemstone::Wounds (class)">Wounds</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all_wounds'><span class='object_link'><a href="Wounds.html#all_wounds-class_method" title="Lich::Gemstone::Wounds.all_wounds (method)">all_wounds</a></span></span>
    <span class='id identifier rubyid_scars'>scars</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Scars.html" title="Lich::Gemstone::Scars (class)">Scars</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all_scars'><span class='object_link'><a href="Scars.html#all_scars-class_method" title="Lich::Gemstone::Scars.all_scars (method)">all_scars</a></span></span>

    <span class='comment'># Update cache
</span>    <span class='ivar'>@wounds_cache</span> <span class='op'>=</span> <span class='id identifier rubyid_wounds'>wounds</span>
    <span class='ivar'>@scars_cache</span> <span class='op'>=</span> <span class='id identifier rubyid_scars'>scars</span>
    <span class='ivar'>@injury_cache_key</span> <span class='op'>=</span> <span class='id identifier rubyid_current_key'>current_key</span>

    <span class='lbracket'>[</span><span class='id identifier rubyid_wounds'>wounds</span><span class='comma'>,</span> <span class='id identifier rubyid_scars'>scars</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="injuries_at_or_above_rank?-class_method">
  
    .<strong>injuries_at_or_above_rank?</strong>(rank, wounds_hash, scars_hash, *parts)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if there are injuries at or above a specific rank for given body parts.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_has_injuries'>has_injuries</span> <span class='op'>=</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='comma'>,</span> <span class='symbol'>:leftArm</span><span class='comma'>,</span> <span class='symbol'>:rightArm</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rank</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The rank of injury to check.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wounds_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing wounds data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scars_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing scars data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>parts</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The body parts to check.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if any part has an injury at or above the specified rank.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_injuries_at_or_above_rank?'>injuries_at_or_above_rank?</span><span class='lparen'>(</span><span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_parts'>parts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='op'>|</span>
    <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_part'>part</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='rparen'>)</span> <span class='op'>&gt;=</span> <span class='id identifier rubyid_rank'>rank</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="injuries_at_rank?-class_method">
  
    .<strong>injuries_at_rank?</strong>(rank, wounds_hash, scars_hash, *parts)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Checks if there are injuries at a specific rank for given body parts.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <h4 class="tag_title">Examples:</h4>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_has_injuries'>has_injuries</span> <span class='op'>=</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='int'>2</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='comma'>,</span> <span class='symbol'>:leftArm</span><span class='comma'>,</span> <span class='symbol'>:rightArm</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>rank</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The rank of injury to check.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>wounds_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing wounds data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scars_hash</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Hash.html" title="Hash (class)">Hash</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A hash containing scars data.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>parts</span>
      
      
        <span class='type'>(<tt>Array&lt;Symbol&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The body parts to check.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>True if any part has an injury at the specified rank.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85
86</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'documented/gemstone/injured.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_injuries_at_rank?'>injuries_at_rank?</span><span class='lparen'>(</span><span class='id identifier rubyid_rank'>rank</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_parts'>parts</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_parts'>parts</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_part'>part</span><span class='op'>|</span>
    <span class='id identifier rubyid_effective_injury_from_hashes'>effective_injury_from_hashes</span><span class='lparen'>(</span><span class='id identifier rubyid_part'>part</span><span class='comma'>,</span> <span class='id identifier rubyid_wounds_hash'>wounds_hash</span><span class='comma'>,</span> <span class='id identifier rubyid_scars_hash'>scars_hash</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='id identifier rubyid_rank'>rank</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan 13 04:43:39 2026 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.38 (ruby-3.2.9).
</div>

    </div>
  <script type="text/javascript">
// Navigation helper for YARD docs
// Adds persistent navigation links, fixes sidebar navigation, and theme toggle

(function() {
  'use strict';

  // Calculate root path for assets
  function getRootPath() {
    var path = window.location.pathname;
    var rootPath = '';

    if (path.includes('/Lich/')) {
      var parts = path.split('/').filter(function(p) { return p; });
      var docsIndex = parts.indexOf('lich-5-docs');
      if (docsIndex >= 0) {
        var subParts = parts.slice(docsIndex + 1);
        rootPath = '../'.repeat(subParts.length - 1);
      }
    }

    if (!rootPath && !path.endsWith('/index.html') && !path.endsWith('/')) {
      var pathParts = path.split('/').filter(function(p) { return p && p !== 'index.html'; });
      var docsIdx = pathParts.indexOf('lich-5-docs');
      if (docsIdx >= 0) {
        rootPath = '../'.repeat(pathParts.length - docsIdx - 2);
      }
    }

    return rootPath;
  }

  // Inject theme CSS
  function injectThemeCSS() {
    if (document.getElementById('theme-css')) return;

    var rootPath = getRootPath();

    // Try multiple paths to find the CSS
    var paths = [
      rootPath + 'css/theme.css',
      'css/theme.css',
      '../css/theme.css',
      '../../css/theme.css',
      '/css/theme.css'
    ];

    var link = document.createElement('link');
    link.id = 'theme-css';
    link.rel = 'stylesheet';
    link.href = paths[0];

    // Add error handler to try alternative paths
    var pathIndex = 0;
    link.onerror = function() {
      pathIndex++;
      if (pathIndex < paths.length) {
        link.href = paths[pathIndex];
      }
    };

    document.head.appendChild(link);

    // Also inject critical inline styles as fallback
    injectInlineStyles();
  }

  // Inject critical inline styles for immediate dark mode
  function injectInlineStyles() {
    if (document.getElementById('theme-inline-css')) return;

    var style = document.createElement('style');
    style.id = 'theme-inline-css';
    style.textContent = [
      '[data-theme="dark"] { --bg-dark: #1a1a2e; --text-dark: #e8e8e8; }',
      '[data-theme="dark"] body { background-color: #1a1a2e !important; color: #e8e8e8 !important; }',
      '[data-theme="dark"] #menu, [data-theme="dark"] .menu, [data-theme="dark"] nav { background-color: #16213e !important; }',
      '[data-theme="dark"] a { color: #5dade2 !important; }',
      '[data-theme="dark"] #full_list, [data-theme="dark"] .objects { background-color: #16213e !important; }',
      '[data-theme="dark"] table th, [data-theme="dark"] thead { background-color: #1e3a5f !important; color: #e8e8e8 !important; }',
      '[data-theme="dark"] table td { background-color: #1a1a2e !important; color: #b8b8b8 !important; }',
      '[data-theme="dark"] input { background-color: #1a1a2e !important; color: #e8e8e8 !important; border-color: #333 !important; }',
      '[data-theme="dark"] small { color: #888 !important; }',
      '[data-theme="dark"] h1, [data-theme="dark"] h2, [data-theme="dark"] h3 { color: #e8e8e8 !important; }'
    ].join('\n');
    document.head.appendChild(style);
  }

  // Get saved theme or detect system preference
  function getPreferredTheme() {
    var saved = localStorage.getItem('yard-theme');
    if (saved) return saved;

    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  }

  // Apply theme to a document
  function applyThemeToDocument(doc, theme) {
    if (!doc || !doc.documentElement) return;
    doc.documentElement.setAttribute('data-theme', theme);

    // Also set on body for broader compatibility
    if (doc.body) {
      doc.body.setAttribute('data-theme', theme);
    }
  }

  // Inject inline styles into a document
  function injectInlineStylesToDocument(doc) {
    if (!doc || !doc.head) return;
    if (doc.getElementById('theme-inline-css')) return;

    var style = doc.createElement('style');
    style.id = 'theme-inline-css';
    style.textContent = [
      '[data-theme="dark"] { --bg-dark: #1a1a2e; --text-dark: #e8e8e8; }',
      '[data-theme="dark"] body { background-color: #1a1a2e !important; color: #e8e8e8 !important; }',
      '[data-theme="dark"] #menu, [data-theme="dark"] .menu, [data-theme="dark"] nav { background-color: #16213e !important; }',
      '[data-theme="dark"] a { color: #5dade2 !important; }',
      '[data-theme="dark"] #full_list, [data-theme="dark"] .objects { background-color: #16213e !important; }',
      '[data-theme="dark"] li { background-color: transparent !important; }',
      '[data-theme="dark"] table th, [data-theme="dark"] thead { background-color: #1e3a5f !important; color: #e8e8e8 !important; }',
      '[data-theme="dark"] table td, [data-theme="dark"] table tr { background-color: #1a1a2e !important; color: #b8b8b8 !important; }',
      '[data-theme="dark"] table tr:nth-child(even), [data-theme="dark"] table tr:nth-child(even) td { background-color: #16213e !important; }',
      '[data-theme="dark"] input { background-color: #1a1a2e !important; color: #e8e8e8 !important; border-color: #333 !important; }',
      '[data-theme="dark"] small { color: #888 !important; }',
      '[data-theme="dark"] h1, [data-theme="dark"] h2, [data-theme="dark"] h3 { color: #e8e8e8 !important; }',
      '[data-theme="dark"] #content { background-color: #1a1a2e !important; }',
      '[data-theme="dark"] pre, [data-theme="dark"] code { background-color: #0d1117 !important; color: #c9d1d9 !important; }'
    ].join('\n');
    doc.head.appendChild(style);
  }

  // Inject theme CSS into a document
  function injectThemeCSSIntoDocument(doc, rootPath) {
    if (!doc || !doc.head) return;

    // Always inject inline styles first as fallback
    injectInlineStylesToDocument(doc);

    if (doc.getElementById('theme-css')) return;

    // Try multiple paths
    var paths = [
      rootPath + 'css/theme.css',
      'css/theme.css',
      '../css/theme.css',
      '../../css/theme.css'
    ];

    var link = doc.createElement('link');
    link.id = 'theme-css';
    link.rel = 'stylesheet';
    link.href = paths[0];

    var pathIndex = 0;
    link.onerror = function() {
      pathIndex++;
      if (pathIndex < paths.length) {
        link.href = paths[pathIndex];
      }
    };

    doc.head.appendChild(link);
  }

  // Apply theme to all frames
  function applyThemeToAllFrames(theme) {
    var rootPath = getRootPath();

    // Apply to main document
    applyThemeToDocument(document, theme);
    injectThemeCSSIntoDocument(document, rootPath);

    // Apply to all frames and iframes
    try {
      var frames = document.querySelectorAll('frame, iframe');
      frames.forEach(function(frame) {
        try {
          var frameDoc = frame.contentDocument || frame.contentWindow.document;
          if (frameDoc) {
            applyThemeToDocument(frameDoc, theme);
            // Calculate root path relative to frame
            var frameRootPath = rootPath || '';
            injectThemeCSSIntoDocument(frameDoc, frameRootPath);
          }
        } catch (e) {
          // Cross-origin frame, skip
        }
      });

      // Also check parent frames (if we're in a frame)
      if (window.parent && window.parent !== window) {
        try {
          applyThemeToDocument(window.parent.document, theme);
          injectThemeCSSIntoDocument(window.parent.document, rootPath);
        } catch (e) {
          // Cross-origin, skip
        }
      }

      // Check top-level window
      if (window.top && window.top !== window) {
        try {
          applyThemeToDocument(window.top.document, theme);
          injectThemeCSSIntoDocument(window.top.document, rootPath);

          // Apply to all frames from top
          var topFrames = window.top.document.querySelectorAll('frame, iframe');
          topFrames.forEach(function(frame) {
            try {
              var frameDoc = frame.contentDocument || frame.contentWindow.document;
              if (frameDoc) {
                applyThemeToDocument(frameDoc, theme);
                injectThemeCSSIntoDocument(frameDoc, '');
              }
            } catch (e) {}
          });
        } catch (e) {
          // Cross-origin, skip
        }
      }
    } catch (e) {
      // Frames not accessible
    }
  }

  // Apply theme
  function applyTheme(theme) {
    localStorage.setItem('yard-theme', theme);

    // Apply to all documents
    applyThemeToAllFrames(theme);

    var btn = document.getElementById('theme-toggle');
    if (btn) {
      btn.textContent = theme === 'dark' ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark';
      btn.title = 'Switch to ' + (theme === 'dark' ? 'light' : 'dark') + ' mode';
    }
  }

  // Toggle theme
  function toggleTheme() {
    var current = document.documentElement.getAttribute('data-theme') || 'light';
    var newTheme = current === 'dark' ? 'light' : 'dark';
    applyTheme(newTheme);
  }

  // Check if we're in a sidebar/list frame (should not add nav)
  function isListFrame() {
    var path = window.location.pathname.toLowerCase();
    // Skip list frames
    if (path.includes('class_list') ||
        path.includes('file_list') ||
        path.includes('method_list') ||
        path.includes('_list.html') ||
        path.includes('frames.html')) {
      return true;
    }
    // Skip if this is a frame with full_list (sidebar)
    if (document.getElementById('full_list') && !document.getElementById('content')) {
      return true;
    }
    // Skip if we're clearly in a sub-frame
    if (window.frameElement) {
      return true;
    }
    return false;
  }

  function addNavLinks() {
    // Don't add nav to list/sidebar frames
    if (isListFrame()) return;

    var content = document.getElementById('content');
    if (!content) return;

    if (document.getElementById('quick-nav')) return;

    var rootPath = getRootPath();

    var nav = document.createElement('div');
    nav.id = 'quick-nav';
    nav.style.cssText = 'padding: 8px 15px; margin-bottom: 15px; border-radius: 4px; border: 1px solid #ddd; font-size: 14px; display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;';

    var links = document.createElement('div');
    links.innerHTML = '<a href="' + rootPath + 'index.html" style="margin-right: 15px; text-decoration: none;">Home</a> | ' +
                      '<a href="' + rootPath + '_index.html" style="margin-left: 15px; margin-right: 15px; text-decoration: none;">All Classes</a> | ' +
                      '<a href="' + rootPath + 'file.psm-reference.html" style="margin-left: 15px; text-decoration: none;">PSM Guide</a>';

    var themeBtn = document.createElement('button');
    themeBtn.id = 'theme-toggle';
    themeBtn.type = 'button';
    themeBtn.onclick = toggleTheme;

    nav.appendChild(links);
    nav.appendChild(themeBtn);

    content.insertBefore(nav, content.firstChild);

    var currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
    themeBtn.textContent = currentTheme === 'dark' ? 'â˜€ï¸ Light' : 'ðŸŒ™ Dark';
    themeBtn.title = 'Switch to ' + (currentTheme === 'dark' ? 'light' : 'dark') + ' mode';
  }

  // Fix sidebar links - only run in actual sidebar/list frames
  function fixAllSidebarLinks() {
    // Only fix links if we're in a list frame
    if (!isListFrame()) return;

    // Get all possible sidebar/menu containers
    var selectors = [
      '#full_list',
      '#menu',
      '.menu',
      '#full_list_content',
      '.class_list',
      '.objects',
      '.sidebar',
      '#list',
      '.y_list'
    ];

    selectors.forEach(function(selector) {
      var containers = document.querySelectorAll(selector);
      containers.forEach(function(container) {
        // Add click handler to container that forces navigation
        if (!container.dataset.navFixed) {
          container.dataset.navFixed = 'true';

          container.addEventListener('click', function(e) {
            // Find the clicked link
            var target = e.target;
            while (target && target !== container) {
              if (target.tagName === 'A') {
                var href = target.getAttribute('href');
                if (href && href !== '#' && !href.startsWith('javascript:')) {
                  e.preventDefault();
                  e.stopPropagation();
                  e.stopImmediatePropagation();

                  // Navigate the parent/top frame, not this frame
                  if (window.parent && window.parent !== window) {
                    window.parent.location.href = target.href;
                  } else if (window.top && window.top !== window) {
                    window.top.location.href = target.href;
                  } else {
                    window.location.href = target.href;
                  }
                  return false;
                }
              }
              target = target.parentNode;
            }
          }, true); // Capture phase
        }

        // Also fix individual links
        var links = container.querySelectorAll('a');
        links.forEach(function(link) {
          if (!link.dataset.navFixed) {
            link.dataset.navFixed = 'true';
            var href = link.getAttribute('href');
            if (href && href !== '#' && !href.startsWith('javascript:')) {
              // Store the original href
              var fullHref = link.href;

              // Override onclick - navigate parent frame
              link.onclick = function(e) {
                e.preventDefault();
                e.stopPropagation();
                if (window.parent && window.parent !== window) {
                  window.parent.location.href = fullHref;
                } else if (window.top && window.top !== window) {
                  window.top.location.href = fullHref;
                } else {
                  window.location.href = fullHref;
                }
                return false;
              };
            }
          }
        });
      });
    });
  }

  // Watch for dynamically loaded content - only in list frames
  function observeForNewLinks() {
    // Only observe in list frames
    if (!isListFrame()) return;

    var observer = new MutationObserver(function(mutations) {
      var hasNewNodes = mutations.some(function(m) {
        return m.addedNodes.length > 0;
      });
      if (hasNewNodes) {
        // Delay slightly to let YARD's JS run first
        setTimeout(fixAllSidebarLinks, 10);
      }
    });

    if (document.body) {
      observer.observe(document.body, {
        childList: true,
        subtree: true
      });
    }
  }

  // Initialize
  function init() {
    injectThemeCSS();
    applyTheme(getPreferredTheme());
    addNavLinks();
    fixAllSidebarLinks();
    observeForNewLinks();
  }

  // Run when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }

  // Run periodically to catch all dynamic content and frames
  var intervals = [50, 100, 250, 500, 1000, 2000, 3000];
  intervals.forEach(function(ms) {
    setTimeout(function() {
      fixAllSidebarLinks();
      // Reapply theme to catch any newly loaded frames
      var theme = localStorage.getItem('yard-theme') || getPreferredTheme();
      applyThemeToAllFrames(theme);
    }, ms);
  });

  // Also run on any click anywhere (last resort) - only in list frames
  document.addEventListener('click', function(e) {
    // Only handle in list frames
    if (!isListFrame()) return;

    if (e.target.tagName === 'A') {
      var href = e.target.getAttribute('href');
      if (href && href !== '#' && !href.startsWith('javascript:')) {
        // Check if it's a sidebar link
        var inSidebar = e.target.closest('#full_list, #menu, .menu, .sidebar');
        if (inSidebar) {
          e.preventDefault();
          e.stopPropagation();
          // Navigate parent frame
          if (window.parent && window.parent !== window) {
            window.parent.location.href = e.target.href;
          } else {
            window.location.href = e.target.href;
          }
        }
      }
    }
  }, true);

  // Listen for system theme changes
  if (window.matchMedia) {
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(e) {
      if (!localStorage.getItem('yard-theme')) {
        applyTheme(e.matches ? 'dark' : 'light');
      }
    });
  }
})();

</script>
</body>
</html>